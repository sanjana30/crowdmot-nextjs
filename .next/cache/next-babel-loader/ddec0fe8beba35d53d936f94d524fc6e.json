{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _this = this,\n    _jsxFileName = \"/Applications/CrowdMOT/crowdmot-nextjs/pages/login.js\",\n    _s = $RefreshSig$();\n\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useState } from \"react\";\nimport { Formik, Form } from \"formik\";\nimport fetch from \"isomorphic-unfetch\";\nimport * as Yup from \"yup\";\nimport Router from \"next/router\";\nimport Cookie from \"js-cookie\";\nimport Input from \"../components/Input\";\nimport Field from \"../components/Field\";\nimport Label from \"../components/Label\";\nimport Button from \"../components/Button\";\n\nvar SignupSchema = function SignupSchema(isSignUp) {\n  return Yup.object().shape({\n    name: isSignUp && Yup.string().min(2, \"too short\").required(\"required\"),\n    email: Yup.string().email(\"not valid\").required(\"required\"),\n    password: Yup.string().min(6, \"too short\").required(\"required\")\n  });\n};\n\n_c = SignupSchema;\nexport default _s(function (props) {\n  _s();\n\n  var _useState = useState(false),\n      isSignUp = _useState[0],\n      setIsSignUp = _useState[1];\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(values, context) {\n      var request, token, error;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return fetch(\"/api/authenticate\", {\n                method: \"POST\",\n                headers: {\n                  \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify(_objectSpread(_objectSpread({}, values), {}, {\n                  isSignUp: isSignUp\n                }))\n              });\n\n            case 2:\n              request = _context.sent;\n              context.setSubmitting(false);\n\n              if (!request.ok) {\n                _context.next = 12;\n                break;\n              }\n\n              _context.next = 7;\n              return request.text();\n\n            case 7:\n              token = _context.sent;\n              Cookie.set(\"_wsp\", token, {\n                secure: false,\n                sameSite: \"lax\"\n              });\n              true && Router.push(\"/\");\n              _context.next = 16;\n              break;\n\n            case 12:\n              _context.next = 14;\n              return request.text();\n\n            case 14:\n              error = _context.sent;\n              context.setErrors({\n                general: error || \"There was a problem authenticating you with that email and password combination.\"\n              });\n\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleSubmit(_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"jsx-4037609192\" + \" \" + \"page\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }\n  }, __jsx(Formik, {\n    initialValues: {\n      name: \"\",\n      email: \"\",\n      password: \"\"\n    },\n    validationSchema: SignupSchema(isSignUp),\n    onSubmit: handleSubmit,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 9\n    }\n  }, function (_ref2) {\n    var errors = _ref2.errors,\n        touched = _ref2.touched,\n        values = _ref2.values,\n        isSubmitting = _ref2.isSubmitting,\n        isValid = _ref2.isValid,\n        getFieldProps = _ref2.getFieldProps;\n    return __jsx(Form, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 13\n      }\n    }, __jsx(\"div\", {\n      className: \"jsx-4037609192\" + \" \" + \"form\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 15\n      }\n    }, isSignUp && __jsx(Field, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 19\n      }\n    }, __jsx(Label, {\n      htmlFor: \"name\",\n      error: touched.name && errors.name,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 21\n      }\n    }, \"\\uD83D\\uDC69\\u200D\\uD83D\\uDCBB Name\"), __jsx(Input, _extends({\n      name: \"name\",\n      id: \"name\",\n      type: \"text\"\n    }, getFieldProps(\"name\"), {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 21\n      }\n    }))), __jsx(Field, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }\n    }, __jsx(Label, {\n      htmlFor: \"email\",\n      error: touched.email && errors.email,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 19\n      }\n    }, \"\\u2709\\uFE0F Email\"), __jsx(Input, _extends({\n      type: \"email\",\n      id: \"email\",\n      name: \"email\"\n    }, getFieldProps(\"email\"), {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 19\n      }\n    }))), __jsx(Field, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 17\n      }\n    }, __jsx(Label, {\n      htmlFor: \"password\",\n      error: touched.password && errors.password,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 19\n      }\n    }, \"\\uD83D\\uDD11 Password\"), __jsx(Input, _extends({\n      id: \"password\",\n      type: \"password\",\n      name: \"password\"\n    }, getFieldProps(\"password\"), {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 19\n      }\n    }))), __jsx(Button, {\n      disabled: isSubmitting || !isValid,\n      loading: isSubmitting,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }\n    }, isSignUp ? \"Sign up\" : \"Log in\"), __jsx(\"p\", {\n      className: \"jsx-4037609192\" + \" \" + \"error\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }\n    }, errors === null || errors === void 0 ? void 0 : errors.general), \" \"));\n  }), __jsx(\"p\", {\n    className: \"jsx-4037609192\" + \" \" + \"log-in-prompt\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 9\n    }\n  }, isSignUp ? \"Have\" : \"Need\", \" an account?\", __jsx(\"span\", {\n    className: \"jsx-4037609192\" + \" \" + \"small\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 11\n    }\n  }, \"Click below, fill out the form, et vola!\")), __jsx(Button, {\n    onClick: function onClick() {\n      return setIsSignUp(!isSignUp);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 9\n    }\n  }, isSignUp ? \"Log in\" : \"Sign up\")), __jsx(_JSXStyle, {\n    id: \"4037609192\",\n    __self: _this\n  }, \".error.jsx-4037609192{text-align:center;color:var(--error);}.page.jsx-4037609192{width:100%;min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}.log-in-prompt.jsx-4037609192{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;margin-top:0.25rem;}.log-in-prompt.jsx-4037609192>.small.jsx-4037609192{font-size:0.75rem;opacity:0.6;}.form.jsx-4037609192{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:300px;}.form.jsx-4037609192>.field,.form.jsx-4037609192>.btn{margin-bottom:0.5rem;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9BcHBsaWNhdGlvbnMvQ3Jvd2RNT1QvY3Jvd2Rtb3QtbmV4dGpzL3BhZ2VzL2xvZ2luLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQXlJa0IsQUFHNkIsQUFJUCxBQVFFLEFBT0ssQUFJTCxBQU1RLFdBeEJKLE9BSkUsQUFtQlAsR0FVZCxPQXhCZSxFQWVmLE9BbkJBLHFDQVd3QixBQVdBLDRCQWpCQSxrREFPSCxBQVdQLFlBQ2QsZ0JBbEJxQixpRUFPSSw0QkFOQSx1RUFPSixtQkFDckIsU0FQQSIsImZpbGUiOiIvQXBwbGljYXRpb25zL0Nyb3dkTU9UL2Nyb3dkbW90LW5leHRqcy9wYWdlcy9sb2dpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBGb3JtaWssIEZvcm0gfSBmcm9tIFwiZm9ybWlrXCI7XG5pbXBvcnQgZmV0Y2ggZnJvbSBcImlzb21vcnBoaWMtdW5mZXRjaFwiO1xuaW1wb3J0ICogYXMgWXVwIGZyb20gXCJ5dXBcIjtcbmltcG9ydCBSb3V0ZXIgZnJvbSBcIm5leHQvcm91dGVyXCI7XG5pbXBvcnQgQ29va2llIGZyb20gXCJqcy1jb29raWVcIjtcbmltcG9ydCBJbnB1dCBmcm9tIFwiLi4vY29tcG9uZW50cy9JbnB1dFwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9jb21wb25lbnRzL0ZpZWxkXCI7XG5pbXBvcnQgTGFiZWwgZnJvbSBcIi4uL2NvbXBvbmVudHMvTGFiZWxcIjtcbmltcG9ydCBCdXR0b24gZnJvbSBcIi4uL2NvbXBvbmVudHMvQnV0dG9uXCI7XG5cbmNvbnN0IFNpZ251cFNjaGVtYSA9IChpc1NpZ25VcCkgPT5cbiAgWXVwLm9iamVjdCgpLnNoYXBlKHtcbiAgICBuYW1lOiBpc1NpZ25VcCAmJiBZdXAuc3RyaW5nKCkubWluKDIsIFwidG9vIHNob3J0XCIpLnJlcXVpcmVkKFwicmVxdWlyZWRcIiksXG4gICAgZW1haWw6IFl1cC5zdHJpbmcoKS5lbWFpbChcIm5vdCB2YWxpZFwiKS5yZXF1aXJlZChcInJlcXVpcmVkXCIpLFxuICAgIHBhc3N3b3JkOiBZdXAuc3RyaW5nKCkubWluKDYsIFwidG9vIHNob3J0XCIpLnJlcXVpcmVkKFwicmVxdWlyZWRcIiksXG4gIH0pO1xuXG5leHBvcnQgZGVmYXVsdCAocHJvcHMpID0+IHtcbiAgY29uc3QgW2lzU2lnblVwLCBzZXRJc1NpZ25VcF0gPSB1c2VTdGF0ZShmYWxzZSk7XG5cbiAgY29uc3QgaGFuZGxlU3VibWl0ID0gYXN5bmMgKHZhbHVlcywgY29udGV4dCkgPT4ge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBhd2FpdCBmZXRjaChcIi9hcGkvYXV0aGVudGljYXRlXCIsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgLi4udmFsdWVzLFxuICAgICAgICBpc1NpZ25VcCxcbiAgICAgIH0pLFxuICAgIH0pO1xuXG4gICAgY29udGV4dC5zZXRTdWJtaXR0aW5nKGZhbHNlKTtcblxuICAgIGlmIChyZXF1ZXN0Lm9rKSB7XG4gICAgICBjb25zdCB0b2tlbiA9IGF3YWl0IHJlcXVlc3QudGV4dCgpO1xuXG4gICAgICBDb29raWUuc2V0KFwiX3dzcFwiLCB0b2tlbiwge1xuICAgICAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcInByb2R1Y3Rpb25cIixcbiAgICAgICAgc2FtZVNpdGU6IFwibGF4XCIsXG4gICAgICB9KTtcblxuICAgICAgcHJvY2Vzcy5icm93c2VyICYmIFJvdXRlci5wdXNoKFwiL1wiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gZXJyb3JzIVxuICAgICAgY29uc3QgZXJyb3IgPSBhd2FpdCByZXF1ZXN0LnRleHQoKTtcblxuICAgICAgY29udGV4dC5zZXRFcnJvcnMoe1xuICAgICAgICBnZW5lcmFsOlxuICAgICAgICAgIGVycm9yIHx8XG4gICAgICAgICAgXCJUaGVyZSB3YXMgYSBwcm9ibGVtIGF1dGhlbnRpY2F0aW5nIHlvdSB3aXRoIHRoYXQgZW1haWwgYW5kIHBhc3N3b3JkIGNvbWJpbmF0aW9uLlwiLFxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPD5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwicGFnZVwiPlxuICAgICAgICA8Rm9ybWlrXG4gICAgICAgICAgaW5pdGlhbFZhbHVlcz17e1xuICAgICAgICAgICAgbmFtZTogXCJcIixcbiAgICAgICAgICAgIGVtYWlsOiBcIlwiLFxuICAgICAgICAgICAgcGFzc3dvcmQ6IFwiXCIsXG4gICAgICAgICAgfX1cbiAgICAgICAgICB2YWxpZGF0aW9uU2NoZW1hPXtTaWdudXBTY2hlbWEoaXNTaWduVXApfVxuICAgICAgICAgIG9uU3VibWl0PXtoYW5kbGVTdWJtaXR9XG4gICAgICAgID5cbiAgICAgICAgICB7KHtcbiAgICAgICAgICAgIGVycm9ycyxcbiAgICAgICAgICAgIHRvdWNoZWQsXG4gICAgICAgICAgICB2YWx1ZXMsXG4gICAgICAgICAgICBpc1N1Ym1pdHRpbmcsXG4gICAgICAgICAgICBpc1ZhbGlkLFxuICAgICAgICAgICAgZ2V0RmllbGRQcm9wcyxcbiAgICAgICAgICB9KSA9PiAoXG4gICAgICAgICAgICA8Rm9ybT5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmb3JtXCI+XG4gICAgICAgICAgICAgICAge2lzU2lnblVwICYmIChcbiAgICAgICAgICAgICAgICAgIDxGaWVsZD5cbiAgICAgICAgICAgICAgICAgICAgPExhYmVsIGh0bWxGb3I9XCJuYW1lXCIgZXJyb3I9e3RvdWNoZWQubmFtZSAmJiBlcnJvcnMubmFtZX0+XG4gICAgICAgICAgICAgICAgICAgICAg8J+RqeKAjfCfkrsgTmFtZVxuICAgICAgICAgICAgICAgICAgICA8L0xhYmVsPlxuICAgICAgICAgICAgICAgICAgICA8SW5wdXRcbiAgICAgICAgICAgICAgICAgICAgICBuYW1lPVwibmFtZVwiXG4gICAgICAgICAgICAgICAgICAgICAgaWQ9XCJuYW1lXCJcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlPVwidGV4dFwiXG4gICAgICAgICAgICAgICAgICAgICAgey4uLmdldEZpZWxkUHJvcHMoXCJuYW1lXCIpfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgPC9GaWVsZD5cbiAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDxGaWVsZD5cbiAgICAgICAgICAgICAgICAgIDxMYWJlbCBodG1sRm9yPVwiZW1haWxcIiBlcnJvcj17dG91Y2hlZC5lbWFpbCAmJiBlcnJvcnMuZW1haWx9PlxuICAgICAgICAgICAgICAgICAgICDinInvuI8gRW1haWxcbiAgICAgICAgICAgICAgICAgIDwvTGFiZWw+XG4gICAgICAgICAgICAgICAgICA8SW5wdXRcbiAgICAgICAgICAgICAgICAgICAgdHlwZT1cImVtYWlsXCJcbiAgICAgICAgICAgICAgICAgICAgaWQ9XCJlbWFpbFwiXG4gICAgICAgICAgICAgICAgICAgIG5hbWU9XCJlbWFpbFwiXG4gICAgICAgICAgICAgICAgICAgIHsuLi5nZXRGaWVsZFByb3BzKFwiZW1haWxcIil9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgIDwvRmllbGQ+XG4gICAgICAgICAgICAgICAgPEZpZWxkPlxuICAgICAgICAgICAgICAgICAgPExhYmVsXG4gICAgICAgICAgICAgICAgICAgIGh0bWxGb3I9XCJwYXNzd29yZFwiXG4gICAgICAgICAgICAgICAgICAgIGVycm9yPXt0b3VjaGVkLnBhc3N3b3JkICYmIGVycm9ycy5wYXNzd29yZH1cbiAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAg8J+UkSBQYXNzd29yZFxuICAgICAgICAgICAgICAgICAgPC9MYWJlbD5cbiAgICAgICAgICAgICAgICAgIDxJbnB1dFxuICAgICAgICAgICAgICAgICAgICBpZD1cInBhc3N3b3JkXCJcbiAgICAgICAgICAgICAgICAgICAgdHlwZT1cInBhc3N3b3JkXCJcbiAgICAgICAgICAgICAgICAgICAgbmFtZT1cInBhc3N3b3JkXCJcbiAgICAgICAgICAgICAgICAgICAgey4uLmdldEZpZWxkUHJvcHMoXCJwYXNzd29yZFwiKX1cbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9GaWVsZD5cbiAgICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgICBkaXNhYmxlZD17aXNTdWJtaXR0aW5nIHx8ICFpc1ZhbGlkfVxuICAgICAgICAgICAgICAgICAgbG9hZGluZz17aXNTdWJtaXR0aW5nfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIHtpc1NpZ25VcCA/IFwiU2lnbiB1cFwiIDogXCJMb2cgaW5cIn1cbiAgICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICA8cCBjbGFzc05hbWU9XCJlcnJvclwiPntlcnJvcnM/LmdlbmVyYWx9PC9wPntcIiBcIn1cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L0Zvcm0+XG4gICAgICAgICAgKX1cbiAgICAgICAgPC9Gb3JtaWs+XG4gICAgICAgIDxwIGNsYXNzTmFtZT1cImxvZy1pbi1wcm9tcHRcIj5cbiAgICAgICAgICB7aXNTaWduVXAgPyBcIkhhdmVcIiA6IFwiTmVlZFwifSBhbiBhY2NvdW50P1xuICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInNtYWxsXCI+XG4gICAgICAgICAgICBDbGljayBiZWxvdywgZmlsbCBvdXQgdGhlIGZvcm0sIGV0IHZvbGEhXG4gICAgICAgICAgPC9zcGFuPlxuICAgICAgICA8L3A+XG4gICAgICAgIDxCdXR0b24gb25DbGljaz17KCkgPT4gc2V0SXNTaWduVXAoIWlzU2lnblVwKX0+XG4gICAgICAgICAge2lzU2lnblVwID8gXCJMb2cgaW5cIiA6IFwiU2lnbiB1cFwifVxuICAgICAgICA8L0J1dHRvbj5cbiAgICAgIDwvZGl2PlxuICAgICAgPHN0eWxlIGpzeD57YFxuICAgICAgICAuZXJyb3Ige1xuICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgICAgICBjb2xvcjogdmFyKC0tZXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIC5wYWdlIHtcbiAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICBtaW4taGVpZ2h0OiAxMDB2aDtcbiAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgfVxuICAgICAgICAubG9nLWluLXByb21wdCB7XG4gICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgICAgbWFyZ2luLXRvcDogMC4yNXJlbTtcbiAgICAgICAgfVxuICAgICAgICAubG9nLWluLXByb21wdCA+IC5zbWFsbCB7XG4gICAgICAgICAgZm9udC1zaXplOiAwLjc1cmVtO1xuICAgICAgICAgIG9wYWNpdHk6IDAuNjtcbiAgICAgICAgfVxuICAgICAgICAuZm9ybSB7XG4gICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICAgIHdpZHRoOiAzMDBweDtcbiAgICAgICAgfVxuICAgICAgICAuZm9ybSA+IDpnbG9iYWwoLmZpZWxkKSxcbiAgICAgICAgLmZvcm0gPiA6Z2xvYmFsKC5idG4pIHtcbiAgICAgICAgICBtYXJnaW4tYm90dG9tOiAwLjVyZW07XG4gICAgICAgIH1cbiAgICAgIGB9PC9zdHlsZT5cbiAgICA8Lz5cbiAgKTtcbn07Il19 */\\n/*@ sourceURL=/Applications/CrowdMOT/crowdmot-nextjs/pages/login.js */\"));\n}, \"G5k7ZK0AyA5xuUnv6Qh+pLEEQ4U=\");\n\nvar _c;\n\n$RefreshReg$(_c, \"SignupSchema\");","map":{"version":3,"sources":["/Applications/CrowdMOT/crowdmot-nextjs/pages/login.js"],"names":["useState","Formik","Form","fetch","Yup","Router","Cookie","Input","Field","Label","Button","SignupSchema","isSignUp","object","shape","name","string","min","required","email","password","props","setIsSignUp","handleSubmit","values","context","method","headers","body","JSON","stringify","request","setSubmitting","ok","text","token","set","secure","sameSite","push","error","setErrors","general","errors","touched","isSubmitting","isValid","getFieldProps"],"mappings":"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","sourcesContent":["import { useState } from \"react\";\nimport { Formik, Form } from \"formik\";\nimport fetch from \"isomorphic-unfetch\";\nimport * as Yup from \"yup\";\nimport Router from \"next/router\";\nimport Cookie from \"js-cookie\";\nimport Input from \"../components/Input\";\nimport Field from \"../components/Field\";\nimport Label from \"../components/Label\";\nimport Button from \"../components/Button\";\n\nconst SignupSchema = (isSignUp) =>\n  Yup.object().shape({\n    name: isSignUp && Yup.string().min(2, \"too short\").required(\"required\"),\n    email: Yup.string().email(\"not valid\").required(\"required\"),\n    password: Yup.string().min(6, \"too short\").required(\"required\"),\n  });\n\nexport default (props) => {\n  const [isSignUp, setIsSignUp] = useState(false);\n\n  const handleSubmit = async (values, context) => {\n    const request = await fetch(\"/api/authenticate\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        ...values,\n        isSignUp,\n      }),\n    });\n\n    context.setSubmitting(false);\n\n    if (request.ok) {\n      const token = await request.text();\n\n      Cookie.set(\"_wsp\", token, {\n        secure: process.env.NODE_ENV === \"production\",\n        sameSite: \"lax\",\n      });\n\n      process.browser && Router.push(\"/\");\n    } else {\n      // errors!\n      const error = await request.text();\n\n      context.setErrors({\n        general:\n          error ||\n          \"There was a problem authenticating you with that email and password combination.\",\n      });\n    }\n  };\n\n  return (\n    <>\n      <div className=\"page\">\n        <Formik\n          initialValues={{\n            name: \"\",\n            email: \"\",\n            password: \"\",\n          }}\n          validationSchema={SignupSchema(isSignUp)}\n          onSubmit={handleSubmit}\n        >\n          {({\n            errors,\n            touched,\n            values,\n            isSubmitting,\n            isValid,\n            getFieldProps,\n          }) => (\n            <Form>\n              <div className=\"form\">\n                {isSignUp && (\n                  <Field>\n                    <Label htmlFor=\"name\" error={touched.name && errors.name}>\n                      üë©‚Äçüíª Name\n                    </Label>\n                    <Input\n                      name=\"name\"\n                      id=\"name\"\n                      type=\"text\"\n                      {...getFieldProps(\"name\")}\n                    />\n                  </Field>\n                )}\n                <Field>\n                  <Label htmlFor=\"email\" error={touched.email && errors.email}>\n                    ‚úâÔ∏è Email\n                  </Label>\n                  <Input\n                    type=\"email\"\n                    id=\"email\"\n                    name=\"email\"\n                    {...getFieldProps(\"email\")}\n                  />\n                </Field>\n                <Field>\n                  <Label\n                    htmlFor=\"password\"\n                    error={touched.password && errors.password}\n                  >\n                    üîë Password\n                  </Label>\n                  <Input\n                    id=\"password\"\n                    type=\"password\"\n                    name=\"password\"\n                    {...getFieldProps(\"password\")}\n                  />\n                </Field>\n                <Button\n                  disabled={isSubmitting || !isValid}\n                  loading={isSubmitting}\n                >\n                  {isSignUp ? \"Sign up\" : \"Log in\"}\n                </Button>\n                <p className=\"error\">{errors?.general}</p>{\" \"}\n              </div>\n            </Form>\n          )}\n        </Formik>\n        <p className=\"log-in-prompt\">\n          {isSignUp ? \"Have\" : \"Need\"} an account?\n          <span className=\"small\">\n            Click below, fill out the form, et vola!\n          </span>\n        </p>\n        <Button onClick={() => setIsSignUp(!isSignUp)}>\n          {isSignUp ? \"Log in\" : \"Sign up\"}\n        </Button>\n      </div>\n      <style jsx>{`\n        .error {\n          text-align: center;\n          color: var(--error);\n        }\n        .page {\n          width: 100%;\n          min-height: 100vh;\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          justify-content: center;\n        }\n        .log-in-prompt {\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          justify-content: center;\n          margin-top: 0.25rem;\n        }\n        .log-in-prompt > .small {\n          font-size: 0.75rem;\n          opacity: 0.6;\n        }\n        .form {\n          display: flex;\n          flex-direction: column;\n          width: 300px;\n        }\n        .form > :global(.field),\n        .form > :global(.btn) {\n          margin-bottom: 0.5rem;\n        }\n      `}</style>\n    </>\n  );\n};"]},"metadata":{},"sourceType":"module"}