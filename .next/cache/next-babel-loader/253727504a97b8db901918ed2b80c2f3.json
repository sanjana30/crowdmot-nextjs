{"ast":null,"code":"import DatabaseService from \"../../services/database\";\nimport AuthService from \"../../services/auth\";\nimport User from \"../../models/user\";\nexport default (async (req, res) => {\n  if (req.method !== \"GET\") {\n    return res.status(405).end();\n  }\n\n  const {\n    authorization\n  } = req.headers;\n  console.log(\"Request headers are: \" + JSON.stringify(req.headers));\n  let userId;\n\n  try {\n    const {\n      id\n    } = await AuthService.verify(authorization);\n    userId = id;\n  } catch (error) {\n    return res.status(401).end();\n  }\n\n  DatabaseService.connect();\n  const user = await User.findOne({\n    _id: userId\n  }, {\n    name: -1\n  });\n  res.json(user.toObject());\n});","map":{"version":3,"sources":["/Applications/CrowdMOT/crowdmot-nextjs/pages/api/user.js"],"names":["DatabaseService","AuthService","User","req","res","method","status","end","authorization","headers","console","log","JSON","stringify","userId","id","verify","error","connect","user","findOne","_id","name","json","toObject"],"mappings":"AAAA,OAAOA,eAAP,MAA4B,yBAA5B;AACA,OAAOC,WAAP,MAAwB,qBAAxB;AACA,OAAOC,IAAP,MAAiB,mBAAjB;AAEA,gBAAe,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACjC,MAAID,GAAG,CAACE,MAAJ,KAAe,KAAnB,EAA0B;AACxB,WAAOD,GAAG,CAACE,MAAJ,CAAW,GAAX,EAAgBC,GAAhB,EAAP;AACD;;AAED,QAAM;AAAEC,IAAAA;AAAF,MAAoBL,GAAG,CAACM,OAA9B;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAY,0BAAwBC,IAAI,CAACC,SAAL,CAAeV,GAAG,CAACM,OAAnB,CAApC;AAEA,MAAIK,MAAJ;;AAEA,MAAI;AACF,UAAM;AAAEC,MAAAA;AAAF,QAAS,MAAMd,WAAW,CAACe,MAAZ,CAAmBR,aAAnB,CAArB;AAEAM,IAAAA,MAAM,GAAGC,EAAT;AACD,GAJD,CAIE,OAAOE,KAAP,EAAc;AACd,WAAOb,GAAG,CAACE,MAAJ,CAAW,GAAX,EAAgBC,GAAhB,EAAP;AACD;;AAEDP,EAAAA,eAAe,CAACkB,OAAhB;AAEA,QAAMC,IAAI,GAAG,MAAMjB,IAAI,CAACkB,OAAL,CAAa;AAAEC,IAAAA,GAAG,EAAEP;AAAP,GAAb,EAA8B;AAAEQ,IAAAA,IAAI,EAAE,CAAC;AAAT,GAA9B,CAAnB;AAEAlB,EAAAA,GAAG,CAACmB,IAAJ,CAASJ,IAAI,CAACK,QAAL,EAAT;AACD,CAvBD","sourcesContent":["import DatabaseService from \"../../services/database\";\nimport AuthService from \"../../services/auth\";\nimport User from \"../../models/user\";\n\nexport default async (req, res) => {\n  if (req.method !== \"GET\") {\n    return res.status(405).end();\n  }\n\n  const { authorization } = req.headers;\n  console.log(\"Request headers are: \"+JSON.stringify(req.headers))\n\n  let userId;\n\n  try {\n    const { id } = await AuthService.verify(authorization);\n\n    userId = id;\n  } catch (error) {\n    return res.status(401).end();\n  }\n\n  DatabaseService.connect();\n\n  const user = await User.findOne({ _id: userId }, { name: -1 });\n\n  res.json(user.toObject());\n};"]},"metadata":{},"sourceType":"module"}